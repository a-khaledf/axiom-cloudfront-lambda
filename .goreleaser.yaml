project_name: axiom-cloudfront-lambda

builds:
  - id: axiom-cloudfront-lambda
    goos:
      - linux
    goarch:
      - amd64
    binary: axiom-cloudfront-lambda
    main: ./cmd/axiom-cloudfront-lambda
    build: 
    env:
      - CGO_ENABLED=0
    tags:
      - osusergo
      - netgo
      - static_build
    flags:
      - -buildvcs=false
      - -buildmode=pie
      - -installsuffix=cgo
      - -trimpath
    ldflags:
      - -s -w -extldflags "-fno-PIC -static -Wl -z now -z relro"
      - -X github.com/axiomhq/pkg/version.release={{ .Version }}
      - -X github.com/axiomhq/pkg/version.revision={{ .ShortCommit }}
      - -X github.com/axiomhq/pkg/version.buildDate={{ .CommitDate }}
      - -X github.com/axiomhq/pkg/version.buildUser=goreleaser
    mod_timestamp: "{{ .CommitTimestamp }}"

archives:
  - id: axiom-cloudfront-lambda
    builds:
      - axiom-cloudfront-lambda
    name_template: "{{ .ProjectName }}_{{ .Version }}"
    wrap_in_directory: true
    format: zip
    files:
      - LICENSE
      - README.md

checksum:
  name_template: checksums.txt

snapshot:
  name_template: "{{ .Tag }}-next"

changelog:
  sort: asc
  filters:
    exclude:
      - "^docs:"
      - "^test:"

milestones:
  - repo:
      owner: axiomhq
      name: axiom-cloudfront-lambda
    close: true
    fail_on_error: false

release:
  github:
    owner: axiomhq
    name: axiom-cloudfront-lambda
  prerelease: auto
  name_template: "Axiom CloudFront Lambda v{{ .Version }}"
